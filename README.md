# Personal Skill Map - AI-Powered Skill Map Visualization

An interactive web application that generates and visualizes career skill maps using AI. Enter any career path and get a comprehensive skill map showing the progression from beginner to advanced skills.

## Features

- **Smart Search**: Enter a specific career or describe your preferences (e.g., "I want to work remotely") - AI analyzes your query and suggests matching careers
- **AI-Generated Skill Maps**: Enter any career (e.g., "Software Engineer", "Data Scientist") and get a complete skill map generated by GPT-4o-mini
- **Master Skill Map**: Dashboard visualization combining all your careers into a unified graph with user center node, career clusters, and skill nodes
- **Interactive Visualization**: Explore skill maps with pan, zoom, and click interactions using React Flow
- **Dynamic Center Node**: Career title node automatically resizes based on text length with adaptive font sizing
- **Dynamic Background**: Animated network background with mouse-reactive nodes
- **Game-Like UI**: Skills displayed with levels, progress bars, and category badges
- **User-Owned Maps**: Logged-in users automatically get personalized copies of skill maps with custom titles and progress tracking
- **Editable Profile**: Update your display name directly from the dashboard with inline editing
- **Auto-Save**: All changes to your maps are automatically saved
- **Sharing**: Make maps public with short shareable URLs - others can view and copy your maps
- **AI Chat Assistant**: Natural language chat to modify skill maps - add skills, merge maps, search trending tech
- **Document Import**: Extract skills from resumes, portfolios, and profiles (PDF, Word, images, URLs) using AI - imported skills are automatically marked as learned
- **Smart Map Merging**: AI-powered merge combining two skill maps with intelligent deduplication
- **Draggable Nodes**: Reposition skills to your preference - positions auto-save and persist
- **Organize Button**: Re-arrange nodes in a neat radial layout with max 6 nodes per ring (auto-triggers after merge)
- **Quick Actions Menu**: 3-dots dropdown on dashboard cards and career page for merge, organize, share, and delete
- **Toast Notifications**: Non-intrusive success/error feedback via react-hot-toast with custom styling
- **Multi-Language Support**: Full internationalization with English, Chinese, and Japanese
- **SEO Optimized**: Dynamic sitemap, robots.txt, hreflang tags, Open Graph/Twitter cards, JSON-LD structured data
- **Smart Caching**: Redis caching prevents redundant API calls and speeds up repeat queries
- **Persistent Storage**: Generated skill maps are saved to PostgreSQL for future access

## Tech Stack

- **Framework**: Next.js 15 (App Router) with Turbopack
- **Database**: Neon (Serverless PostgreSQL) with Drizzle ORM
- **Caching**: Upstash Redis (HTTP-based)
- **AI**: OpenAI API (GPT-4o-mini)
- **Visualization**: React Flow (@xyflow/react)
- **Styling**: Tailwind CSS v4
- **Animation**: Framer Motion
- **i18n**: next-intl (locale-prefixed URLs)
- **Validation**: Zod
- **Package Manager**: pnpm

## Getting Started

### Prerequisites

- Node.js 18+
- pnpm
- Neon PostgreSQL database
- Upstash Redis instance
- OpenAI API key

### Installation

1. Clone the repository:
   ```bash
   git clone <repository-url>
   cd ai-skill-tree-website
   ```

2. Install dependencies:
   ```bash
   pnpm install
   ```

3. Set up environment variables:
   ```bash
   cp .env.example .env.local
   ```

4. Fill in your credentials in `.env.local`:
   ```env
   # Neon PostgreSQL
   DATABASE_URL="postgresql://user:password@host/database?sslmode=require"

   # Upstash Redis
   UPSTASH_REDIS_REST_URL="https://your-redis.upstash.io"
   UPSTASH_REDIS_REST_TOKEN="your-token"

   # OpenAI
   OPENAI_API_KEY="sk-..."

   # NextAuth
   NEXTAUTH_URL="http://localhost:3000"
   NEXTAUTH_SECRET="your-secret"

   # Google OAuth
   GOOGLE_CLIENT_ID="..."
   GOOGLE_CLIENT_SECRET="..."

   # Twitter OAuth (optional)
   TWITTER_CLIENT_ID="..."
   TWITTER_CLIENT_SECRET="..."

   # WeChat OAuth (optional - login disabled if not set)
   WECHAT_APP_ID="..."
   WECHAT_APP_SECRET="..."

   # Tavily Web Search (optional - trending tech search disabled if not set)
   TAVILY_API_KEY="tvly-..."
   ```

5. Push the database schema:
   ```bash
   pnpm drizzle-kit push
   ```

6. Start the development server:
   ```bash
   pnpm dev
   ```

7. Open [http://localhost:3000](http://localhost:3000) in your browser.

## Project Structure

```
├── app/
│   ├── [locale]/           # Locale-prefixed pages (en, zh, ja)
│   │   ├── (marketing)/
│   │   │   └── page.tsx        # Landing page with animated hero
│   │   ├── career/
│   │   │   └── [careerId]/
│   │   │       └── page.tsx    # Career detail with skill graph
│   │   ├── dashboard/
│   │   │   └── page.tsx        # User dashboard
│   │   └── layout.tsx          # Locale layout with providers
│   ├── api/
│   │   ├── ai/
│   │   │   ├── analyze/        # Query analysis (specific vs vague)
│   │   │   ├── chat/           # AI chat for skill map modifications
│   │   │   └── generate/       # AI skill map generation
│   │   ├── career/             # Career CRUD operations
│   │   ├── import/             # Document import (PDF, Word, images, URLs)
│   │   └── map/                # User map operations
│   ├── globals.css             # Tailwind CSS with custom theme
│   ├── sitemap.ts              # Dynamic sitemap with all locales
│   ├── robots.ts               # Robots.txt configuration
│   ├── icon.png                # App icon (192x192)
│   ├── apple-icon.png          # Apple touch icon (180x180)
│   └── favicon.ico             # Browser favicon
├── components/
│   ├── ai-chat/
│   │   ├── AIChatPanel.tsx     # Floating AI chat panel with import
│   │   ├── ChatMessage.tsx     # Chat message display
│   │   ├── ChatInput.tsx       # Text input with send button
│   │   ├── ModificationPreview.tsx # Changes confirmation modal
│   │   └── MergeMapModal.tsx   # Map merge UI
│   ├── import/
│   │   ├── DocumentImportModal.tsx # File/URL import modal
│   │   └── ImportPreview.tsx   # Extracted skills preview
│   ├── layout/
│   │   ├── Header.tsx              # Site header with navigation
│   │   └── SkillTreeBackground.tsx # Animated network background
│   ├── skill-graph/
│   │   ├── SkillNode.tsx       # Custom skill node component
│   │   ├── SkillEdge.tsx       # Custom animated edge
│   │   └── SkillGraph.tsx      # Main graph component
│   ├── seo/
│   │   └── JsonLd.tsx          # JSON-LD structured data components
│   └── ui/
│       ├── GlassPanel.tsx      # Glassmorphism container
│       ├── Icons.tsx           # Reusable SVG icons
│       ├── SearchInput.tsx     # Search input with customizable width
│       ├── DropdownMenu.tsx    # 3-dots action menu
│       ├── ConfirmModal.tsx    # Styled confirmation dialog
│       ├── Toast.tsx           # Toast notifications wrapper
│       └── LanguageSwitcher.tsx # Language dropdown selector
├── i18n/                       # Internationalization config
├── messages/                   # Translation files (en, zh, ja)
├── lib/
│   ├── db/                     # Database connection & schema
│   ├── mcp/
│   │   └── tavily.ts           # Tavily web search integration
│   ├── ai.ts                   # OpenAI integration (career generation)
│   ├── ai-chat.ts              # AI chat utilities (modifications, merge)
│   ├── ai-document.ts          # Document skill extraction with vision
│   ├── document-parser.ts      # PDF, Word, image, URL parsing
│   ├── cache.ts                # Redis cache utilities
│   ├── constants.ts            # Centralized app constants
│   └── schemas.ts              # Zod validation schemas
├── public/
│   ├── icon-transparent-bg.png      # App icon (standard)
│   └── large-icon-transparent-bg.png # Large icon for hero
└── package.json
```

## Key Components

### SkillTreeBackground

An animated SVG background with:
- Grid-based node distribution with organic variation
- Network connections between nearby nodes
- Mouse-reactive nodes (attraction and scale effects)
- Configurable via `BACKGROUND_CONFIG` in `lib/constants.ts`

### Header

Fixed navigation header with:
- App logo with white circular background
- Responsive navigation links (configured via `NAV_LINKS` constant)
- Mobile hamburger menu with animated slide-down panel
- Language switcher
- User authentication menu
- Scroll-aware styling (transparent to blur backdrop)

### SearchInput

Flexible search input component with:
- Customizable width via `className` prop
- Loading state with spinner
- Gradient submit button

## Configuration

All configurable values are centralized in `lib/constants.ts`:

```typescript
// Asset paths
ASSETS.ICON              // Standard icon path
ASSETS.ICON_LARGE        // Large icon for hero

// App branding
APP_NAME                 // "Personal Skill Map"

// Routes (centralized route paths)
ROUTES.HOME              // "/"
ROUTES.DASHBOARD         // "/dashboard"
ROUTES.PROFILE           // "/profile"
ROUTES.CAREER            // "/career"

// Header behavior
HEADER_SCROLL_THRESHOLD  // Pixels before header style changes
NAV_LINKS                // Navigation links array for header

// Background animation
BACKGROUND_CONFIG.GRID_CELL_SIZE
BACKGROUND_CONFIG.NODE_SKIP_RATE
BACKGROUND_CONFIG.COLORS
BACKGROUND_CONFIG.MOUSE_INTERACTION_RADIUS
// ... and more

// Hero animation
HERO_ICON_ROTATION_DURATION  // Seconds per rotation

// SEO
SITE_URL                     // Base site URL
APP_DESCRIPTION              // Meta description

// AI Chat
AI_CHAT_CONFIG.model         // OpenAI model (gpt-4o-mini)
AI_CHAT_CONFIG.maxTokens     // Token limit (4000)
AI_CHAT_CONFIG.temperature   // Response randomness (0.7)
AI_CHAT_CONFIG.chatHistoryLimit // Messages in context (10)

// User Profile
USER_NAME_MAX_LENGTH         // Max characters for user name (100)

// API Routes (for client-side)
API_ROUTES.AI_CHAT           // /api/ai/chat
API_ROUTES.AI_MERGE          // /api/ai/merge
API_ROUTES.USER_GRAPH        // /api/user/graph
API_ROUTES.USER_PROFILE      // /api/user/profile
API_ROUTES.MAP               // /api/map

// Tavily Web Search
TAVILY_CONFIG.apiUrl                    // API endpoint
TAVILY_CONFIG.defaultSearchDepth        // 'basic' | 'advanced'
TAVILY_CONFIG.trendingTech.includeDomains // Trusted domains for tech search
TAVILY_CONFIG.careerSkills.includeDomains // Trusted domains for career search

// Map Merge
MERGE_CONFIG.similarityThreshold        // Threshold for "recommended" maps (0.3)

// Document Import
DOCUMENT_IMPORT_CONFIG.maxFileSizeBytes           // Max file size (20MB)
DOCUMENT_IMPORT_CONFIG.charsPerToken              // Chars per token for truncation (4)
DOCUMENT_IMPORT_CONFIG.fileTypes                  // Supported file type definitions (pdf, word, text, image)
DOCUMENT_IMPORT_CONFIG.urlTimeout                 // URL fetch timeout (30s)
DOCUMENT_IMPORT_CONFIG.userAgent                  // Bot user agent for URL fetching
DOCUMENT_IMPORT_CONFIG.portfolioDomains           // Domains to detect as portfolio sites
DOCUMENT_IMPORT_CONFIG.aiExtraction.visionModel   // GPT-4o for images
DOCUMENT_IMPORT_CONFIG.aiExtraction.textModel     // gpt-4o-mini for text
DOCUMENT_IMPORT_CONFIG.aiExtraction.minSkills     // Min skills to extract (10)
DOCUMENT_IMPORT_CONFIG.aiExtraction.maxSkills     // Max skills to extract (25)
DOCUMENT_IMPORT_CONFIG.aiExtraction.existingSkillsLimit  // Max existing skills in context (20)
DOCUMENT_IMPORT_CONFIG.preview.confidenceThresholds      // High/medium confidence thresholds
// Derived constants
SUPPORTED_FILE_ACCEPT                             // HTML file input accept string
```

## API Routes

### POST `/api/ai/analyze`
Analyze a user query to determine if it's a specific career or needs suggestions.
- Specific career → returns `{ type: "specific", career: CareerSuggestion }`
- Vague/lifestyle query → returns `{ type: "suggestions", suggestions: CareerSuggestion[] }`

### POST `/api/ai/generate`
Generate a new skill map for a career.

### POST `/api/ai/chat`
AI-powered chat for skill map modifications. Supports streaming responses.
- Accepts: message, skill map context, chat history, locale
- Returns: AI response with optional skill modifications
- Features: Tavily web search for trending tech, scope guard for off-topic requests

### POST `/api/ai/merge`
AI-powered smart merge of two skill maps.
- Accepts: source/target nodes and edges, career titles, locale
- Returns: Merged nodes, edges, and suggested title
- Requires authentication

### GET `/api/career/[careerId]?locale=en`
Fetch an existing career by its canonical key or UUID.

### GET `/api/career/search?q=engineer`
Search for careers matching a query.

### Document Import API
- `POST /api/import/document` - Upload and parse file (PDF, Word, images)
  - Accepts: multipart/form-data with file, locale, optional existing context
  - Returns: Extracted skills, edges, suggested title, confidence score
  - Uses GPT-4o vision for images, gpt-4o-mini for text documents
- `POST /api/import/url` - Import from URL (LinkedIn, GitHub, etc.)
  - Accepts: URL, locale, optional existing context
  - Returns: Extracted skills with Tavily fallback for blocked pages

### User Maps API
- `GET /api/map/[mapId]` - Fetch map by UUID or share slug
- `PATCH /api/map/[mapId]` - Update map settings
- `DELETE /api/map/[mapId]` - Delete a user's map
- `POST /api/map/fork` - Create map from base career or imported skills
- `POST /api/map/[mapId]/copy` - Copy public map to your account

### User Profile API
- `PATCH /api/user/profile` - Update user profile (name)

## Deployment

This app is optimized for Vercel deployment:

1. Push to GitHub
2. Connect to Vercel
3. Add environment variables in Vercel dashboard
4. Deploy

## License

MIT
